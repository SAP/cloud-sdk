In the previous version of the SAP Cloud SDK, all OData types were always deserialized to a specific TypeScript data type and vice versa, `moment` being the default for all OData date/time properties.
In version 2.0, a new flexible middleware concept has been introduced that allows configuring custom implementations for serialization and de-serialization of all data types.
You can set your custom (de-)serialization middleware by passing it as a parameter to the common service method (e.g. `businessPartnerService`).
This parameter is optional.
When left unset, the default implementation is used.

Below example shows a custom middleware example for `Edm.Date` with `dayjs`:

```ts
import dayjs from 'dayjs';

function dayjsCustomDeserializationFunc(date: string): dayjs {
const parsed = dayjs(date, 'YYYY-MM-DD', true);
  if (!parsed.isValid()) {
    throw new Error(
      `Provided date value ${date} does not follow the Edm.Date pattern: YYYY-MM-DD`
    );
  }
  return parsed;
}

function dayjsCustomSerializationFunc(date: dayjs): string {
  return date.format('YYYY-MM-DD');
}

const customMiddleware = {
  'Edm.Date': {
    deserialize: dayjsCustomDeserializationFunc
    serialize: dayjsCustomSerializationFunc
  }
}
```

You can now pass this middleware as a parameter to the `businessPartnerService` method to set it globally for all entities in the OData client.

```ts
const { businessPartnerApi } = businessPartnerService(customMiddleware);
businessPartnerApi.entityBuilder()
.firstName('Peter')
.lastName('Pan')
.organizationFoundationDate(dayjs({ year :2010, month :3, day :5})
.build();
```

#### Using `Temporal` Middleware

`Temporal` proposes classes for all data types required to handle OData types (for example, `PlainDate`, `PlainTime`, `PlainDateTime`, `Duration` and, `ZonedDateTime`).
We have also provided a temporal-based middleware if you would like to switch from `moment`.
This implementation is available as a separate npm package `@sap-cloud-sdk/temporal-de-serializers`.
Adapt your code to use this package:

```ts
import { temporalDeSerializersV4 } from '@sap-cloud-sdk/temporal-de-serializers';
const { businessPartnerApi } = businessPartnerService(temporalDeSerializersV4);
businessPartnerApi
  .entityBuilder()
  .organizationFoundationDate(
    Temporal.PlainDateTime.from('1995-12-07T03:24:30')
  )
  .build();
```

`Temporal` is currently at Stage 3 of the TC39 process. We will switch the default date/time (de-)serialization from `moment` to Temporal when it reaches Stage 4.
