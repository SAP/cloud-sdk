---
title: Executing a Request Using a Generated OpenAPI Client
sidebar_label: Execute an OpenAPI Request
description: This article describes how to generate a client from the a service definition and how to use the client.
keywords:
  - sap
  - cloud
  - sdk
  - OpenAPI
  - rest
  - connectivity
  - JavaScript
  - TypeScript
---

import useBaseUrl from '@docusaurus/useBaseUrl';

:::note
The OpenAPI generator is currently beta. We do not recommend to use it in production as there might still be breaking changes.
:::

The usage of the OpenAPI clients is similar to the clients for [OData](../odata/execute-odata-request).
The OpenAPI clients consist of at least one API, which in turn has at least one function.
What APIs and functions are available in a client depends on the service specification.

## Executing a Request

The request execution always follows the same structure.
You invoke a function of an API, optionally configure your request and then execute it against a [destination](../connectivity/destination):

```ts
const responseData = await MyApi.myFunction().execute(destination);
```

In the example above we invoke the function `myFunction` of the API `MyApi` without further configuration and execute it against a destination named `destination`.
The `execute` method returns the response data directly.

You can configure your request by [setting custom headers](#set-custom-headers), [a custom request configuration](#set-a-custom-request-configuration) or [disabling CSRF token fetching](#disable-csrf-token-fetching).
If you need more information than the response data, you can also [get the raw response](#get-a-raw-response).

### Passing Parameters

Often, resources are accessible under paths that require path parameters and/or query parameters and write requests often send a request body to modify resources.
The clients generated by the SAP Cloud SDK OpenAPI generator require you to set the parameters that are mandatory and allow you to set those that are optional.

#### Path Parameters

Path parameters are always mandatory.
If path parameters are present in the path pattern for a request, e.g. `'/my-resource/{resourceId}'`, those are the the first mandatory arguments in the generated function, e.g. `MyApi.getMyResource(resourceId)`.
The types of the arguments depend on the specification.
Their names are always camel case and the order is determined by their occurrence in the path pattern.

#### Query Parameters

Query parameters can be both mandatory and optional.
If query parameters for a certain API function exist, they are always the last argument of the function.
Query parameters are provided as an object, e.g. if you can set a `limit` parameter, `MyApi.getMyResource(resourceId, { limit: 10 })`.
The types of the parameters depend on the specification.
Their names are as specified in the original OpenAPI document.

#### Request Bodies

Request bodies can be both mandatory and optional.
The according function argument is always `body` and it is always between the path and query parameters, e.g. when the body is a simple object containing a title, `MyApi.updateMyResource(resourceId, { title: 'My Title' }, { lang: 'en' })`.
It the request body is optional, you have to pass `undefined`, e.g. `MyApi.updateMyResource(resourceId, undefined, { lang: 'en' })`.

### Set Custom Headers

The SDK sets all mandatory headers by default.
To set additional headers or change the default values used in the headers, use the `withCustomHeaders` method.
You can pass an object, where the key is the name of the header and the value, well the value.

```ts
MyApi.myFunction()
  .setCustomHeaders({
    apikey: 'my-api-key'
  })
  .execute(destination);
```

Custom headers take precedence over default headers.
The example above can come in handy, when executing requests against the sandbox systems of the SAP SPI Business Hub.

### Set a Custom Request Configuration

### Disable CSRF Token Fetching

### Get a Raw Response

### `GET` Operations Without Parameters

Assuming you have a specification without
The root path `/entities` in combination with the operation `GET` will retrieve all entities.
The SAP Cloud SDK uses the `operationId` value of the specification file to name the method if possible.
In the example the `operationId` is `getAllEntities` and the method is executed in the following way:

```ts
import { TestServiceApi } from './outputDirectory/test-service';

const allTestEntities = await TestServiceApi.getAllEntities().execute(
  myDestination
);
```

The type of `allTestEntities` is `Promise<TestEntity[]>` and `myDestination` is the destination object explained in the [connectivity guide](../connectivity/destination).

### `GET` Operation With Parameter

The path `/entities/{entityId}` has a parameter of type `string` and it will return the entity by the given key.
The `operationId` is `getEntityByKey` and the path parameter is passed as an argument:

```ts
import { TestServiceApi } from './outputDirectory/test-service';

const myEntity = await TestServiceApi.getEntityByKey('myId').execute(
  myDestination
);
```

Note that the result of this request is also typed as `Promise<TestEntity>`.

### `GET` Operations With Longer Paths

The path `root/someThing` will get `someThing` from the root entity.
In our example we have a `entities/count` which will return the number of entities and is named `countEntities`:

```ts
import { TestServiceApi } from './outputDirectory/test-service';

const numberOfEntities = await TestServiceApi.countEntities().execute(
  myDestination
);
```

where the type of the response is `Promise<number>`.

### `POST` Operations

For the `entities` path the operation `POST` is also allowed.
This corresponds to the creation of new entities.
You create a entity in the following way:

```ts
import { TestServiceApi, TestEntity } from './outputDirectory/test-service';

const testEntity: TestEntity = {
  keyProperty: 'some-id-in-uuid-format',
  stringProperty: 'myProperty'
};
const createResponse = await TestServiceApi.createEntity(testEntity).execute(
  restDestination
);
```

The `POST` operation is [specified](https://github.com/SAP/cloud-sdk-js/blob/main/test-resources/rest-service-specs/test-service.json) to return no content and status code `201 Created`.
Hence the `createResponse` is typed as `Promise<void>`.

:::note
If your server requires CSRF tokens for a `POST` request, you have to fetch and provide it manually as custom header in the `execute()` method.
The OpenAPI clients currently don't support automatic token fetching.
:::
