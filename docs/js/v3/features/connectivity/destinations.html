<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-docs-js docs-version-v3 docs-doc-page docs-doc-id-features/connectivity/destinations" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Destinations | SAP Cloud SDK</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://sap.github.io/cloud-sdk/docs/js/v3/features/connectivity/destinations"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v3"><meta data-rh="true" name="docusaurus_tag" content="docs-docs-js-v3"><meta data-rh="true" name="docsearch:version" content="v3"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-docs-js-v3"><meta data-rh="true" name="robots" content="noindex, nofollow"><meta data-rh="true" property="og:title" content="Destinations | SAP Cloud SDK"><meta data-rh="true" name="description" content="This article describes how destinations are fetched in the SDK and how they can be configured."><meta data-rh="true" property="og:description" content="This article describes how destinations are fetched in the SDK and how they can be configured."><meta data-rh="true" name="keywords" content="sap,cloud,sdk,destination,connectivity,JavaScript,TypeScript"><link data-rh="true" rel="icon" href="/cloud-sdk/favicon.ico"><link data-rh="true" rel="canonical" href="https://sap.github.io/cloud-sdk/docs/js/v3/features/connectivity/destinations"><link data-rh="true" rel="alternate" href="https://sap.github.io/cloud-sdk/docs/js/v3/features/connectivity/destinations" hreflang="en"><link data-rh="true" rel="alternate" href="https://sap.github.io/cloud-sdk/docs/js/v3/features/connectivity/destinations" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://E4A268JVO0-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Destinations","item":"https://sap.github.io/cloud-sdk/docs/js/v3/features/connectivity/destinations"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="SAP Cloud SDK" href="/cloud-sdk/opensearch.xml"><link rel="stylesheet" href="/cloud-sdk/assets/css/styles.c8db7810.css">
<script src="/cloud-sdk/assets/js/runtime~main.54cd9325.js" defer="defer"></script>
<script src="/cloud-sdk/assets/js/main.75bcfd61.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme",window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-theme-choice","system"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/cloud-sdk/img/logo.svg"><link rel="preload" as="image" href="/cloud-sdk/img/logo-dark.svg"><link rel="preload" as="image" href="/cloud-sdk/img/destination-property-sap-client.png"><link rel="preload" as="image" href="/cloud-sdk/img/destination-additional-properties.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cloud-sdk/"><div class="navbar__logo"><img src="/cloud-sdk/img/logo.svg" alt="SAP Cloud SDK" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/cloud-sdk/img/logo-dark.svg" alt="SAP Cloud SDK" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">SAP Cloud SDK</b></a><a class="navbar__item navbar__link" href="/cloud-sdk/docs/overview/overview-cloud-sdk">Overview</a><a class="navbar__item navbar__link" docspluginid="docs-java" href="/cloud-sdk/docs/java/overview-cloud-sdk-for-java">â˜• Java</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" docspluginid="docs-js" href="/cloud-sdk/docs/js/overview">ðŸš€ JavaScript</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://sap.github.io/ai-sdk" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">SAP Cloud SDK for AI<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/cloud-sdk/docs/js/v3/features/connectivity/destinations">v3</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/cloud-sdk/docs/js/features/connectivity/destinations">v4</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/cloud-sdk/docs/js/v3/features/connectivity/destinations">v3</a></li><li><a class="dropdown__link" href="/cloud-sdk/docs/js/v2/features/connectivity/destinations">v2</a></li><li><a class="dropdown__link" href="/cloud-sdk/docs/js/v1/features/connectivity/destinations">v1</a></li></ul></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-sdk/docs/js/v3/overview"><span title="Overview" class="linkLabel_WmDU">Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-sdk/docs/js/v3/getting-started"><span title="Getting Started" class="linkLabel_WmDU">Getting Started</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/cloud-sdk/docs/js/v3/features/odata/overview"><span title="Features" class="categoryLinkLabel_W154">Features</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/cloud-sdk/docs/js/v3/features/odata/overview"><span title="OData" class="categoryLinkLabel_W154">OData</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/cloud-sdk/docs/js/v3/features/connectivity/destinations"><span title="Connectivity" class="categoryLinkLabel_W154">Connectivity</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cloud-sdk/docs/js/v3/features/connectivity/destinations"><span title="Destinations" class="linkLabel_WmDU">Destinations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/js/v3/features/connectivity/destination-cache"><span title="Destination Cache" class="linkLabel_WmDU">Destination Cache</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/js/v3/features/connectivity/proxies"><span title="Proxies" class="linkLabel_WmDU">Proxies</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/js/v3/features/connectivity/http-client"><span title="Perform HTTP Requests" class="linkLabel_WmDU">Perform HTTP Requests</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/js/v3/features/connectivity/csrf"><span title="CSRF Fetching" class="linkLabel_WmDU">CSRF Fetching</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/js/v3/features/connectivity/on-premise"><span title="On-Premise Systems" class="linkLabel_WmDU">On-Premise Systems</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/cloud-sdk/docs/js/v3/features/openapi/overview"><span title="OpenAPI" class="categoryLinkLabel_W154">OpenAPI</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/cloud-sdk/docs/js/v3/features/mail-client"><span title="Mail Client" class="categoryLinkLabel_W154">Mail Client</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/js/v3/features/middleware"><span title="Middleware" class="linkLabel_WmDU">Middleware</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/js/v3/features/error-handling"><span title="Error Handling" class="linkLabel_WmDU">Error Handling</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/js/v3/features/logging"><span title="Logging" class="linkLabel_WmDU">Logging</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/js/v3/features/eslint-configuration"><span title="Shared ESLint configuration" class="linkLabel_WmDU">Shared ESLint configuration</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cloud-sdk/docs/js/v3/environments/kubernetes"><span title="Environments" class="categoryLinkLabel_W154">Environments</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cloud-sdk/docs/js/v3/guides/upgrade-to-version-3"><span title="Guides" class="categoryLinkLabel_W154">Guides</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cloud-sdk/docs/js/v3/tutorials/getting-started/introduction"><span title="Tutorials" class="categoryLinkLabel_W154">Tutorials</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cloud-sdk/docs/js/v3/release-policy"><span title="Releases" class="categoryLinkLabel_W154">Releases</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cloud-sdk/docs/js/v3/video/calm"><span title="Video Tutorials" class="categoryLinkLabel_W154">Video Tutorials</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="/cloud-sdk/api/v3/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK"><span title="API Reference" class="linkLabel_WmDU">API Reference</span><svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-sdk/docs/js/v3/release-notes"><span title="Release Notes" class="linkLabel_WmDU">Release Notes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-sdk/docs/js/v3/support"><span title="Support" class="linkLabel_WmDU">Support</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-sdk/docs/js/v3/troubleshooting"><span title="Troubleshooting" class="linkLabel_WmDU">Troubleshooting</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cloud-sdk/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Features</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Connectivity</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Destinations</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Destinations</h1></header><p>Destinations represent information about a target system.
A destination is an object with the following information, among others:</p>
<ul>
<li class="">URL</li>
<li class="">authentication configuration</li>
<li class=""><a class="" href="/cloud-sdk/docs/js/v3/features/connectivity/proxies">proxy settings</a></li>
</ul>
<p>Destinations in the SAP Cloud SDK are based on the SAP Business Technology Platform (SAP BTP) concept of destinations for convenient communication between SAP BTP and other systems.
On SAP BTP, destinations are managed separately from applications and can be retrieved through the destination service at runtime.
Some reasons to separate destinations and the application are:</p>
<ul>
<li class="">You can securely store authentication information that should not be part of the application code.</li>
<li class="">You can update resource locations without touching the application code.</li>
<li class="">Different customers may want to configure different systems.</li>
<li class="">Multiple applications might want to access the same systems.</li>
</ul>
<p>Use <a href="/cloud-sdk/api/v3/interfaces/sap-cloud-sdk_connectivity.Destination.html" target="_blank" rel="noopener noreferrer" class="">destinations</a> to execute <a class="" href="/cloud-sdk/docs/js/v3/features/connectivity/http-client">arbitrary requests</a>, <a class="" href="/cloud-sdk/docs/js/v3/features/odata/overview">OData requests</a>, and <a class="" href="/cloud-sdk/docs/js/v3/features/openapi/overview">OpenAPI requests</a> as well as to <a class="" href="/cloud-sdk/docs/js/v3/features/mail-client">send e-mails</a>.
The following examples use <code>req.execute()</code>, assuming req is an OData or OpenAPI request, to demonstrate options for the destination lookup.
The same options apply to <code>executeHttpRequest()</code> and <code>sendMail()</code>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="referencing-destinations-by-name">Referencing Destinations by Name<a href="#referencing-destinations-by-name" class="hash-link" aria-label="Direct link to Referencing Destinations by Name" title="Direct link to Referencing Destinations by Name" translate="no">â€‹</a></h2>
<p>To reference a destination, pass an object with <code>destinationName</code>:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> destinationName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DESTINATION&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>The SAP Cloud SDK searches for the destination by its name in the following locations and order:</p>
<ol>
<li class="">local environment variables</li>
<li class="">destinations registered in the SAP Cloud SDK</li>
<li class="">service binding environment variables</li>
<li class="">SAP BTP&#x27;s destination service</li>
</ol>
<p>The search stops once a matching destination is found, even if other locations may contain another matching destination.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="local-environment-variable">Local Environment Variable<a href="#local-environment-variable" class="hash-link" aria-label="Direct link to Local Environment Variable" title="Direct link to Local Environment Variable" translate="no">â€‹</a></h3>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>You should use this option <strong>only for testing purposes in local environments</strong> outside the SAP BTP where no destination service is available.
If you want to cache destinations in production, use <a href="#register-destination" class=""><code>registerDestination()</code></a> instead.</p></div></div>
<p>You can provide destinations in the <code>destinations</code> environment variable.
The value of the environment variable is expected to be a stringified JSON array, where the items adhere to the <a href="/cloud-sdk/api/v3/interfaces/sap-cloud-sdk_connectivity.Destination.html" target="_blank" rel="noopener noreferrer" class="">Destination interface</a>.</p>
<p>Example:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;[{\&quot;name\&quot;: \&quot;TESTINATION\&quot;, \&quot;url\&quot;: \&quot;http://url.hana.ondemand.com\&quot;, \&quot;username\&quot;: \&quot;DUMMY_USER\&quot;, \&quot;password\&quot;: \&quot;EXAMPLE_PASSWORD\&quot;}]&quot;</span><br></span></code></pre></div></div>
<p>At runtime, the SAP Cloud SDK will check the environment variable for a destination with the given name and use it, if present.
This allows you to use different destinations in different environments, e.g. a destination from the destination service in production and a destination from the <code>destinations</code> environment variable for local development.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Note that this approach is <strong>not suitable for multi-tenant scenarios</strong>.</p></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="testing-with-local-environment-variables">Testing with Local Environment Variables<a href="#testing-with-local-environment-variables" class="hash-link" aria-label="Direct link to Testing with Local Environment Variables" title="Direct link to Testing with Local Environment Variables" translate="no">â€‹</a></h4>
<p>The SAP Cloud SDK provides a <code>setTestDestination()</code> function to add a destination to the environment variable for the current process programmatically.
It takes a <a href="/cloud-sdk/api/v3/interfaces/sap-cloud-sdk_connectivity.Destination.html" target="_blank" rel="noopener noreferrer" class="">destination object</a>, transforms it to a JSON object, and adds it to <code>process.env.destinations</code>.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> setTestDestination </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@sap-cloud-sdk/test-util&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">setTestDestination</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  authentication</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NoAuthentication&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;TESTINATION&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  isTrustingAllCertificates</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;https://example.com&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>In the above example, a destination with the name &quot;TESTINATION&quot; is added to the <code>destination</code> environment variable.</p>
<p>The SAP Cloud SDK also offers a <code>mockTestDestination()</code> method, which reads in a <code>systems.json</code> and <code>credentials.json</code> to create destinations.
The advantage of files is that they can be excluded from the repository, if they contain sensitive information.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="register-destination">Register Destination<a href="#register-destination" class="hash-link" aria-label="Direct link to Register Destination" title="Direct link to Register Destination" translate="no">â€‹</a></h3>
<p>You can provide named destinations to your application, by registering them in your application.
This is particularly helpful for service-to-service communication, where authentication is handled within a cluster and reaching out to the destination service would cause unnecessary overhead.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> registerDestination </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@sap-cloud-sdk/connectivity&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">registerDestination</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DESTINATION&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;https://example.com&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> destinationName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DESTINATION&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>In the example above a destination is registered under the name &quot;DESTINATION&quot; using <code>regsiterDestination()</code>.
After that, you can reference this destination by passing its name.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>You can register a full destination object, including authentication, but it is <strong>not recommended</strong> to store authentication information in the registered destination.
Instead, you should enable token forwarding on the destination.</p></div></div>
<p>With <a href="#forwarding-auth-token" class="">token forwarding</a> the token used to execute the request is sent to the destination:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> destination </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;FORWARD-DESTINATION&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;https://example.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  forwardAuthToken</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">registerDestination</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">destination</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  destinationName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;FORWARD-DESTINATION&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  jwt</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;forwardedJwt&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>Note that the <code>registerDestination()</code> function is tenant-aware.
The <a class="" href="/cloud-sdk/docs/js/v3/features/connectivity/destination-cache">destination cache guide</a> describes the cache options used by the <code>registerDestination()</code> function.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-mutual-tls-authentication-mtls-on-cloud-foundry">Using Mutual TLS authentication (mTLS) on Cloud Foundry<a href="#using-mutual-tls-authentication-mtls-on-cloud-foundry" class="hash-link" aria-label="Direct link to Using Mutual TLS authentication (mTLS) on Cloud Foundry" title="Direct link to Using Mutual TLS authentication (mTLS) on Cloud Foundry" translate="no">â€‹</a></h4>
<p>Using <a href="https://en.wikipedia.org/wiki/Mutual_authentication#mTLS" target="_blank" rel="noopener noreferrer" class="">mTLS</a> means that both the client and the server check each other&#x27;s TLS certificate.
This might be a requirement in some microservice-based deployments.</p>
<p>The SAP Cloud SDK for JavaScript supports registering destinations with mTLS on Cloud Foundry based on <a href="https://docs.cloudfoundry.org/devguide/deploy-apps/instance-identity.html" target="_blank" rel="noopener noreferrer" class="">Instance Identity Credentials</a>.</p>
<p>Set the <code>inferMtls</code> option to <code>true</code> in the <code>RegisterDestinationOptions</code> object:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">const options: RegisterDestinationOptions = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inferMtls: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre></div></div>
<p>This configures HTTPS requests to automatically check for the <code>CF_INSTANCE_CERT</code> and <code>CF_INSTANCE_KEY</code> environment variables and read the certificate and key.</p>
<p>The caching of mTLS certificates is disabled by default, but can be enabled by adding the <code>useCache</code> option:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">const options: RegisterDestinationOptions = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inferMtls: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  useCache: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre></div></div>
<p>Certificates are then cached for the entire validity time of the certificate.
Since in Cloud Foundry each deployment has their own mTLS certificate, the cache is shared among all tenants of a deployment.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="service-binding-environment-variables">Service Binding Environment Variables<a href="#service-binding-environment-variables" class="hash-link" aria-label="Direct link to Service Binding Environment Variables" title="Direct link to Service Binding Environment Variables" translate="no">â€‹</a></h3>
<p>The service bindings (also known as the <code>VCAP_SERVICES</code> environment variable) represent services bound to the application.
You can consume bound services as destinations to execute requests against those services.
When you execute a request against a bound service, the name of the destination is the service instance name.
The SAP Cloud SDK retrieves the according service binding and passes it to a callback function, that transforms the service to a destination.</p>
<p>The SAP Cloud SDK provides a default implementation for the transformation of service bindings of the following types:</p>
<ul>
<li class=""><code>business-logging</code></li>
<li class=""><code>s4-hana-cloud</code></li>
<li class=""><code>destination</code></li>
<li class=""><code>saas-registry</code></li>
<li class=""><code>workflow</code></li>
<li class=""><code>service-manager</code></li>
<li class=""><code>xsuaa</code></li>
<li class=""><code>aicore</code></li>
</ul>
<p>The default implementation also retrieves a service token, if needed.</p>
<p>Additionally, we provide a function to transform service bindings into OAuth2ClientCredentials destinations, assuming the service binding follows the structure outlined below:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;VCAP_SERVICES&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;custom-service&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;my-custom-service&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;label&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;custom-service&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;tags&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;custom-service&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;url&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://example.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;credentials&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;clientid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;CLIENT_ID&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;clientsecret&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;CLIENT_SECRET&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>If the service URL is not specified in the <code>url</code> property, it can alternatively be provided as part of the <code>options</code> parameter.</p>
<p>The following is a multi-tenant example, where the user&#x27;s JWT is used for tenant-isolation in the cache together with a custom URL as target.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> serviceBinding </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getServiceBinding</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;custom-service&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> userJwt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">retrieveJwt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> destination </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getDestinationFromServiceBinding</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  destinationName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;custom-service&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  jwt</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> userJwt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  useCache</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">transformServiceBindingToClientCredentialsDestination</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serviceBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;custom-url&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> jwt</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> userJwt </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>For other types of service bindings or if you want to overwrite the default behavior, provide a callback function (<code>serviceBindingTransformFn()</code>) in the request execution.</p>
<p>For example, if you have a binding for a custom service:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;VCAP_SERVICES&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;custom-service&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// This object is passed to `serviceBindingTransformFn()`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;my-custom-service&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;label&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;custom-service&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;credentials&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;url&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://example.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;usr&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;USERNAME&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;pwd&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;PASSWORD&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>To transform this custom service binding you need to provide the <code>serviceBindingTransformFn()</code> function.
In the example below, we access the <code>service.credentials</code> to create a destination with authentiction type &quot;BasicAuthentication&quot;.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  destinationName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;my-custom-service&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function-variable function" style="color:#d73a49">serviceBindingTransformFn</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">service</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> service</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">credentials</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    authentication</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;BasicAuthentication&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    username</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> service</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">credentials</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">usr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    password</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> service</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">credentials</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>Note, that if your <code>serviceBindingTransformFn()</code> function does not provide a name in the transformed destination, it will automatically be inferred from the given destination name, i.e. &#x27;my-custom-service&#x27; in the example above.</p>
<p>More advanced examples with service token fetching can be found in <a href="https://github.com/SAP/cloud-sdk-js/blob/main/packages/connectivity/src/scp-cf/destination/service-binding-to-destination.ts" target="_blank" rel="noopener noreferrer" class="">service-binding-to-destination.ts</a>.</p>
<p>If you want to skip the destination lookup and consider only the service bindings, call the <a href="/cloud-sdk/api/v3/functions/sap-cloud-sdk_connectivity.getDestinationFromServiceBinding.html" target="_blank" rel="noopener noreferrer" class="">getDestinationFromServiceBinding()</a> function with the service name and options.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> destination </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getDestinationFromServiceBinding</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  destinationName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;my-service-name&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  serviceBindingTransformFn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  jwt</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;jwt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  useCache</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Creating destinations from service bindings</div><div class="admonitionContent_BuS1"><p>The SAP Cloud SDK provides the <code>getServiceBinding()</code> function to retrieve the first service binding from <code>VCAP_SERVICES</code> for a given service type.
It also provides the <code>transformServiceBindingToDestination()</code> function to transform known service bindings to destinations.</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Example Usage</summary><div><div class="collapsibleContent_i85q"><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  getServiceBinding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  transformServiceBindingToDestination</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@sap-cloud-sdk/connectivity&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> service </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getServiceBinding</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;aicore&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">transformServiceBindingToDestination</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">service</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div></div></div></details><p><code>transformServiceBindingToDestination()</code> supports the <a href="#service-binding-environment-variables" class="">default service types</a> as listed above.</p><p>The transformation includes auth token flows for destinations with type <code>OAuth2ClientCredentials</code> and adds retrieved tokens to the destination.
If the provided service binding is not supported, an error is thrown.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="destination-service">Destination Service<a href="#destination-service" class="hash-link" aria-label="Direct link to Destination Service" title="Direct link to Destination Service" translate="no">â€‹</a></h3>
<p>In a productive environment, in most cases you will use the <a href="https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/7e306250e08340f89d6c103e28840f30.html" target="_blank" rel="noopener noreferrer" class="">destination service</a> to retrieve destinations.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="authentication-and-json-web-token-jwt-retrieval">Authentication and JSON Web Token (JWT) Retrieval<a href="#authentication-and-json-web-token-jwt-retrieval" class="hash-link" aria-label="Direct link to Authentication and JSON Web Token (JWT) Retrieval" title="Direct link to Authentication and JSON Web Token (JWT) Retrieval" translate="no">â€‹</a></h4>
<p>To access the destination service, the SAP Cloud SDK will first fetch an access token from the XSUAA service.
The token retrieved from the XSUAA service is used to make a call to the destination service and receive the destinations.
The destination service returns a destination with all relevant authentication information depending on the used authentication flow.
Listed below are the SDK-supported authentication flows, categorized based on whether a user JWT (<code>jwt</code> property in <a href="#destination-fetch-options" class="">destination fetch options</a>) is required to retrieve a destination.</p>
<ul>
<li class="">
<p>No user JWT required</p>
<ul>
<li class=""><code>NoAuthentication</code></li>
<li class=""><code>BasicAuthentication</code></li>
<li class=""><code>OAuth2ClientCredentials</code></li>
<li class=""><code>OAuth2Password</code></li>
<li class=""><code>ClientCertificateAuthentication</code></li>
<li class=""><code>OAuth2RefreshToken</code></li>
</ul>
</li>
<li class="">
<p>User JWT required</p>
<ul>
<li class=""><code>OAuth2UserTokenExchange</code></li>
<li class=""><code>OAuth2JWTBearer</code></li>
<li class=""><code>OAuth2SAMLBearerAssertion</code></li>
<li class=""><code>PrincipalPropagation</code></li>
</ul>
</li>
</ul>
<p>The SAP Cloud SDK automatically parses the response of the destination service and uses the provided authentication information for the request to the target system.
For a simple service, this would be the end of the story.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="multi-tenancy">Multi-Tenancy<a href="#multi-tenancy" class="hash-link" aria-label="Direct link to Multi-Tenancy" title="Direct link to Multi-Tenancy" translate="no">â€‹</a></h4>
<p>However, the destination service is special in the way that it is a tenant-aware service.
Such services make it possible to build multi-tenant applications.
So, what defines a tenant-aware service?</p>
<p>Assume you want to build an application showing the five newest business partners in an SAP S/4HANA system.
You want to offer this application as a service to customers.
Of course, you want to make this service cost-efficient and host it only once and let multiple customers use it.
This means your service needs to return the data related to specific customers.
A customer is represented by an account on the SAP BTP.
A service considering that account is a tenant-aware service.</p>
<p>Tenant-aware services on the SAP BTP are offered to customers via a subscription which works on a high level as follows:
If a customer wants to use a service, a subscription is created linking the customer account and the one account hosting the service.
In the following, the term &quot;subscriber account&quot; will be used for the accounts using a service and &quot;provider account&quot; for the one hosting it.</p>
<p>For simplicity, an optional argument of the destination lookup has been neglected in the beginning:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> destinationName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DESTINATION&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> jwt</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;JWT&gt;&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>The <code>jwt</code> argument takes the JSON web token (JWT) issued by an XSUAA as input.
Additional information on how to retrieve JWTs can be found <a class="" href="/cloud-sdk/docs/js/v3/guides/retrieve-jwt">here</a>.
This token contains a field <code>zid</code> holding the tenant id, which will be used in the lookup process.
The lookup process done by the SAP Cloud SDK involves the following steps:</p>
<ul>
<li class="">Request an access token for the destination service and a given tenant ID from the XSUAA.</li>
<li class="">Due to the subscription between provider and subscriber, the XSUAA is allowed to issue the token.</li>
<li class="">The token allows for calling the destination service on behalf of the given tenant.
The tenant and service information is encoded in the access token.</li>
<li class="">Make a call to the destination service using the obtained access token.</li>
<li class="">The destination maintained in the given tenant is returned.</li>
</ul>
<p>If no token is given or the destination is not found in the subscriber account, the provider account is used as a fallback.
To control this fallback behavior, a selection strategy can be passed to the destination lookup:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> alwaysSubscriber </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@sap-cloud-sdk/connectivity&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  destinationName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DESTINATION&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  jwt</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;yourJWT&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selectionStrategy</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> alwaysSubscriber</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>The SAP Cloud SDK defines the following selection strategies:</p>
<ul>
<li class=""><code>alwaysSubscriber</code>: Only try to get destinations from the subscriber account.
A valid JWT is mandatory to receive something.</li>
<li class=""><code>alwaysProvider</code>: Only try to get the destination from the provider account.
A JWT is not needed.
Even if you present a subscriber JWT, the provider destination will be returned if present.</li>
<li class=""><code>subscriberFirst</code>: Tries to get from the subscriber first using the JWT.
If no valid JWT is provided or the destination is not found, it tries the provider as described for <code>AlwaysProvider</code>.</li>
</ul>
<p>The selection strategy can be passed as an optional argument to the <code>execute()</code> method.
The default value is <code>subscriberFirst</code>.
The selection strategies can be used to control for which account a destination lookup is attempted:</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>In principle, it is possible to define destinations not only on the account level but also on the destination service level.
These destinations are called instance destinations since they are tied to a service binding called instance on SAP BTP.
In every request, these destinations are added to the destinations returned by the destination service.</p></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="destination-lookup-without-a-json-web-token-jwt">Destination Lookup Without a JSON Web Token (JWT)<a href="#destination-lookup-without-a-json-web-token-jwt" class="hash-link" aria-label="Direct link to Destination Lookup Without a JSON Web Token (JWT)" title="Direct link to Destination Lookup Without a JSON Web Token (JWT)" translate="no">â€‹</a></h4>
<p>There are situations where you do not have a JWT issued by the XSUAA but need to look up a destination, e.g., in background processes.
In such situations, the property <code>iss</code> of the <code>DestinationAccessorOptions</code> can be used:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> destinationName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DESTINATION&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> iss</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> yourIssuerValue </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>The value for <code>iss</code> is supposed to be the same as in a JWT issued from the XSUAA, e.g., <code>https://yourSubdomain.localhost:8080/uaa/oauth/token</code>.
In principle, only the host of the URL is relevant, but since the same parsing and replacement methods are used for the JWT handling, the URL has to be provided in the format above.</p>
<p>Some destinations have <a href="#authentication-and-json-web-token-jwt-retrieval" class="">user-related authentication flows</a> and require user information to be present.
When working with the <code>iss</code> property, you can add a JWT to include user information.
This will be used to identify the user in the <code>x-user-token</code> header in the request to the destination service.</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><p>If only a JWT is used in the destination lookup, it is validated.
This validation ensures that the JWT has not been manipulated.
If <code>iss</code> is provided, no such validation is performed.</p><p>Note that the given subdomain value defines from which tenant destinations are fetched.
<strong>A wrong value may break the isolation for tenants.</strong></p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="getting-all-destinations">Getting All Destinations<a href="#getting-all-destinations" class="hash-link" aria-label="Direct link to Getting All Destinations" title="Direct link to Getting All Destinations" translate="no">â€‹</a></h3>
<p>The SAP Cloud SDK supports getting all destinations only from the destination service.
This is possible through the <code>getAllDestinationsFromDestinationService()</code> function.
Based on the provided JWT, you will either receive all subscriber or provider destinations.</p>
<p>Example:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> getAllDestinationsFromDestinationService </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@sap-cloud-sdk/connectivity&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Will attempt to get all provider destinations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">getAllDestinationsFromDestinationService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Will attempt to get all subscriber destinations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">getAllDestinationsFromDestinationService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">subscriberJWT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>It is important to note that these destinations won&#x27;t contain an authentication token.
If you need the token, call the specific destination with <code>getDestination({destinationName: yourDestination})</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="destination-fetch-options">Destination Fetch Options<a href="#destination-fetch-options" class="hash-link" aria-label="Direct link to Destination Fetch Options" title="Direct link to Destination Fetch Options" translate="no">â€‹</a></h3>
<p>The <code>execute()</code>, <code>getDestination()</code>, and <code>executeHttpRequest()</code> functions perform a destination lookup by name as discussed above.
You can pass options to adjust how the destination is fetched.
A few of the options were already listed above, but this section gives a comprehensive overview:</p>
<ul>
<li class=""><code>destinationName</code>: The name of the destination to be fetched.
This is the only mandatory property, all the other parameters are optional.</li>
<li class=""><code>serviceBindingTransformFn</code>: A custom transformation function to control how a <code>Destination</code> is built from the given <code>Service</code>.</li>
<li class=""><code>jwt</code>: The JSON Web Token.
The property is mandatory in the following cases:<!-- -->
<ul>
<li class="">User-dependent authentication flow is used, e.g., <code>OAuth2UserTokenExchange</code>, <code>OAuth2JWTBearer</code>, <code>OAuth2SAMLBearerAssertion</code>, <code>SAMLAssertion</code> or <code>PrincipalPropagation</code>.</li>
<li class="">Multi-tenant scenarios with destinations maintained in the subscriber account. This case is implied if the <code>selectionStrategy</code> is set to <code>alwaysSubscriber</code>.</li>
</ul>
</li>
<li class=""><code>iss</code>: Issuer URL which can be used to obtain destination for a subscriber tenant if no JWT is present.
Read the detailed documentation above before using this option.</li>
<li class=""><code>refreshToken</code>: A refresh token.
Is used to fetch a new access token without performing the original authentication flow.
It has a longer validity compared to access tokens.
This field is mandatory for destinations with authentication type <code>OAuth2RefreshToken</code>.</li>
<li class=""><code>selectionStrategy</code>: Specifies the order in which accounts are searched for a destination.
Default is <code>subscriberFirst</code>.
Alternative values are <code>alwaysProvider</code> and <code>alwaysSubscriber</code>.</li>
<li class=""><code>iasToXsuaaTokenExchange</code>: Switches on token exchange from IAS format tokens to XSUAA if needed using the <code>@sap/xssec</code> library.
The default value is <code>true</code>.</li>
<li class=""><code>cacheVerificationKeys</code>: Switches on caching for the verification certificates for the JWT.
The default value is <code>true</code>.</li>
<li class=""><code>useCache</code>: Switches on caching for destinations received from the destination service.
The default value is <code>false</code>.</li>
<li class=""><code>isolationStrategy</code>: Specifies how the destination cache is scoped.
The value is automatically set but <a class="" href="/cloud-sdk/docs/js/v3/features/connectivity/destination-cache">under certain conditions</a> you may want to optimize it.</li>
<li class=""><code>retry</code>: Switches on three retries for the request to the destination service.
The retries apply only to the call that performs the token exchange, which may be flaky, depending on the token endpoint.
The default value is <code>false</code>.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="destination-properties">Destination Properties<a href="#destination-properties" class="hash-link" aria-label="Direct link to Destination Properties" title="Direct link to Destination Properties" translate="no">â€‹</a></h2>
<p>The destination object may contain additional properties.
The properties change the behavior of how the SAP Cloud SDK handles the HTTP request at runtime.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="sap-client">SAP Client<a href="#sap-client" class="hash-link" aria-label="Direct link to SAP Client" title="Direct link to SAP Client" translate="no">â€‹</a></h3>
<p>The property <code>sap-client</code> is considered by the SAP Cloud SDK.
When this property is set, it is used as the header parameter <code>sap-client</code> with the specified value in the HTTP request to the target system.</p>
<img alt="SAP client property on destination" src="/cloud-sdk/img/destination-property-sap-client.png" class="center">
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="trust-configuration">Trust Configuration<a href="#trust-configuration" class="hash-link" aria-label="Direct link to Trust Configuration" title="Direct link to Trust Configuration" translate="no">â€‹</a></h3>
<p>By default, SAP BTP only trusts certain certificate authorities.
If you want to make HTTPS requests against systems that use certificates from other certificate authorities, you can configure the following properties:</p>
<ol>
<li class=""><code>TrustStoreLocation</code>: The SAP Cloud SDK adds the provided certificate in the <code>ca</code> property of the <a href="https://nodejs.org/api/tls.html#tlscreatesecurecontextoptions" target="_blank" rel="noopener noreferrer" class="">node client</a>.</li>
<li class=""><code>TrustAll</code>: The SAP Cloud SDK adds the inverted value as the <a href="https://nodejs.org/api/tls.html#class-tlstlssocket" target="_blank" rel="noopener noreferrer" class=""><code>rejectUnauthorized</code></a></li>
</ol>
<p>For additional information on trust configuration have a look at <a class="" href="/cloud-sdk/docs/js/v3/guides/trust-and-keystores">the more detailed guide</a>.</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><p>Please use the <code>TrustAll</code> with <strong>great caution</strong> since it opens the gate to man-in-the-middle attacks.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="jwt-validation">JWT Validation<a href="#jwt-validation" class="hash-link" aria-label="Direct link to JWT Validation" title="Direct link to JWT Validation" translate="no">â€‹</a></h3>
<p>If you use JWTs not issued by the XSUAA service, you can configure validation by the destination service using the <code>x_user_token.jwks</code> or <code>x_user_token.jwks_uri</code> property.
For more details on JWTs, have a look at the more detailed <a class="" href="/cloud-sdk/docs/js/v3/guides/retrieve-jwt">guide</a>.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>If you want to use a custom JWT in combination with the destination cache, the JWT must contain the properties <code>zid</code> and <code>user_id</code>.
These properties are used to construct the cache key.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="additional-headers-and-query-parameters-on-destinations">Additional Headers and Query Parameters on Destinations<a href="#additional-headers-and-query-parameters-on-destinations" class="hash-link" aria-label="Direct link to Additional Headers and Query Parameters on Destinations" title="Direct link to Additional Headers and Query Parameters on Destinations" translate="no">â€‹</a></h3>
<p>The destination service has a convention to define static headers and query parameters on destinations.
Create additional properties in your destination in the SAP BTP cockpit and define their values as follows:</p>
<ul>
<li class=""><code>URL.headers.HEADER_KEY</code> for headers</li>
<li class=""><code>URL.queries.QUERY_KEY</code> for query parameters</li>
</ul>
<p>Replace <code>HEADER_KEY</code> and <code>QUERY_KEY</code> with the name of the headers or query parameters and set the respective values.</p>
<img alt="Additional properties on destination" src="/cloud-sdk/img/destination-additional-properties.png" class="center">
<p>In the example above, the destination has an <code>apiKey</code> header with the value <code>&lt;my-api-key&gt;</code> and a <code>language</code> query parameter with the value <code>EN</code>.</p>
<p>The SAP Cloud SDK adds those additional headers and query parameters for every communication with the given destination.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="forwarding-auth-tokens">Forwarding Auth Tokens<a href="#forwarding-auth-tokens" class="hash-link" aria-label="Direct link to Forwarding Auth Tokens" title="Direct link to Forwarding Auth Tokens" translate="no">â€‹</a></h3>
<p>The SDK provides the option of configuring a destination to directly forward the given JWT to the target system.
This behavior can be enabled by setting the <code>forwardAuthToken</code> property on the destination to <code>true</code>, as shown in the code snippet below:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> destination </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DESTINATION&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;https://example.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  forwardAuthToken</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Now, when you reference the destination in a request, where you pass a JWT, the JWT is passed to the target system in the authorization header.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Sends a request with the JWT in the headers: { authorization: &#x27;Bearer &lt;JWT&gt;&#x27; }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> destinationName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DESTINATION&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> jwt</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;JWT&gt;&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>Forwarding a JWT is only intended with authentication type &quot;NoAuthentication&quot;.
For other authentication types the forwarded JWT will override the default authentication which can lead to unexpected behavior.</p>
<p>Custom authorization headers in the <code>requestConfig</code> take precedence over the forwarded JWT.</p>
<p>This approach only works, if the target system accepts unchanged JWTs.
If any transformation is required, e.g., from <code>OAuth</code> to <code>SamlBearer</code>, it is recommended to use the destination service.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="html5forwardauthtoken-vs-forwardauthtoken"><code>HTML5.ForwardAuthToken</code> vs. <code>forwardAuthToken</code><a href="#html5forwardauthtoken-vs-forwardauthtoken" class="hash-link" aria-label="Direct link to html5forwardauthtoken-vs-forwardauthtoken" title="Direct link to html5forwardauthtoken-vs-forwardauthtoken" translate="no">â€‹</a></h4>
<p>To enable token forwarding for destinations in the destination service, set either <code>HTML5.ForwardAuthToken</code> or <code>forwardAuthToken</code> to <code>true</code>.
Every other value is interpreted as <code>false</code>.
If both options are specified only the value passed to <code>forwardAuthToken</code> is used.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="rules-of-precedence">Rules of Precedence<a href="#rules-of-precedence" class="hash-link" aria-label="Direct link to Rules of Precedence" title="Direct link to Rules of Precedence" translate="no">â€‹</a></h4>
<p>The SAP Cloud SDK adds headers and query parameters from different sources.
Some sources take precedence over others (highest to lowest):</p>
<ol>
<li class=""><strong>custom</strong>: headers/query parameters added to a request directly</li>
<li class=""><strong>additional properties</strong>: headers/query parameters defined on a destination</li>
<li class=""><strong>internal</strong>: headers/query parameters built by the SAP Cloud SDK</li>
</ol>
<p>Headers or query parameters built by the SAP Cloud SDK are overwritten by additional headers and query parameters on the destination.
Custom headers and query parameters, however, overwrite the additional properties.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p><strong>Header names</strong> keep their casing but overwrite other headers independent of the casing, e.g., <code>AUTHORIZATION</code> overwrites <code>authorization</code>.
This does not apply to query <strong>parameter names</strong>`.</p></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="creating-destinations-manually">Creating Destinations Manually<a href="#creating-destinations-manually" class="hash-link" aria-label="Direct link to Creating Destinations Manually" title="Direct link to Creating Destinations Manually" translate="no">â€‹</a></h2>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>This option is <strong>not recommended</strong> for productive use as you would lose the benefits of separating destinations from applications.</p></div></div>
<p>You can construct a destination object manually and pass the destination information directly to the <code>execute()</code> method.
A manually constructed destination requires at least a <code>url</code> property.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;https://example.com&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/SAP/cloud-sdk/edit/main/docs-js_versioned_docs/version-v3/features/connectivity/destination.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cloud-sdk/docs/js/v3/features/odata/v4-client"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">OData v4 Client API</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cloud-sdk/docs/js/v3/features/connectivity/destination-cache"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Destination Cache</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#referencing-destinations-by-name" class="table-of-contents__link toc-highlight">Referencing Destinations by Name</a><ul><li><a href="#local-environment-variable" class="table-of-contents__link toc-highlight">Local Environment Variable</a></li><li><a href="#register-destination" class="table-of-contents__link toc-highlight">Register Destination</a></li><li><a href="#service-binding-environment-variables" class="table-of-contents__link toc-highlight">Service Binding Environment Variables</a></li><li><a href="#destination-service" class="table-of-contents__link toc-highlight">Destination Service</a></li><li><a href="#getting-all-destinations" class="table-of-contents__link toc-highlight">Getting All Destinations</a></li><li><a href="#destination-fetch-options" class="table-of-contents__link toc-highlight">Destination Fetch Options</a></li></ul></li><li><a href="#destination-properties" class="table-of-contents__link toc-highlight">Destination Properties</a><ul><li><a href="#sap-client" class="table-of-contents__link toc-highlight">SAP Client</a></li><li><a href="#trust-configuration" class="table-of-contents__link toc-highlight">Trust Configuration</a></li><li><a href="#jwt-validation" class="table-of-contents__link toc-highlight">JWT Validation</a></li><li><a href="#additional-headers-and-query-parameters-on-destinations" class="table-of-contents__link toc-highlight">Additional Headers and Query Parameters on Destinations</a></li><li><a href="#forwarding-auth-tokens" class="table-of-contents__link toc-highlight">Forwarding Auth Tokens</a></li></ul></li><li><a href="#creating-destinations-manually" class="table-of-contents__link toc-highlight">Creating Destinations Manually</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">SAP Cloud SDK for Java</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://developers.sap.com/tutorial-navigator.html?tag=products:technology-platform/sap-cloud-sdk/sap-cloud-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">Tutorials<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://central.sonatype.com/search?q=g:com.sap.cloud.sdk*&amp;smo=true" target="_blank" rel="noopener noreferrer" class="footer__link-item">Maven<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/cloud-sdk/docs/java/support">Support</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">SAP Cloud SDK for JavaScript</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/cloud-sdk/docs/js/tutorials/getting-started/introduction">Tutorials</a></li><li class="footer__item"><a href="https://www.npmjs.com/search?q=%40sap-cloud-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">npm<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/SAP/cloud-sdk-js" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/SAP-samples/cloud-sdk-js" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sample repository<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/cloud-sdk/docs/js/support">Support</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Additional Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/sap-cloud-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://community.sap.com/topics/cloud-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">SAP Cloud SDK Community Page<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://answers.sap.com/tags/73555000100800000895" target="_blank" rel="noopener noreferrer" class="footer__link-item">SAP Cloud SDK on SAP Answers<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://help.sap.com/viewer/product/SAP_CLOUD_SDK/1.0/en-US?task=discover_task" target="_blank" rel="noopener noreferrer" class="footer__link-item">SAP Cloud SDK on SAP Help<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://sap.github.io/ai-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">SAP Cloud SDK for AI<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2026 SAP SE or an SAP affiliate company. All rights reserved.</div></div></div></footer></div>
</body>
</html>