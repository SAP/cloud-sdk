"use strict";(self.webpackChunksap_cloud_sdk_documentation=self.webpackChunksap_cloud_sdk_documentation||[]).push([[30864],{83863:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"guides/browser","title":"Use the SAP Cloud SDK in the Browser","description":"You\'ll learn how to package SDK for a browser, what are the limitations, and how to use it with popular frontend frameworks.","source":"@site/docs-js_versioned_docs/version-v3/guides/sdk-in-browser.mdx","sourceDirName":"guides","slug":"/guides/browser","permalink":"/cloud-sdk/docs/js/v3/guides/browser","draft":false,"unlisted":false,"editUrl":"https://github.com/SAP/cloud-sdk/edit/main/docs-js_versioned_docs/version-v3/guides/sdk-in-browser.mdx","tags":[],"version":"v3","frontMatter":{"id":"browser","title":"Use the SAP Cloud SDK in the Browser","sidebar_label":"Use the SAP Cloud SDK in the Browser","description":"You\'ll learn how to package SDK for a browser, what are the limitations, and how to use it with popular frontend frameworks.","keywords":["sap","cloud","sdk","cloud native","cloud sdk","sap cloud sdk"]},"sidebar":"docsJsSidebar","previous":{"title":"Connecting to External Systems from BAS","permalink":"/cloud-sdk/docs/js/v3/guides/bas"},"next":{"title":"Trust and Keystores","permalink":"/cloud-sdk/docs/js/v3/guides/trust-and-keystores"}}');var o=s(74848),t=s(28453);const i={id:"browser",title:"Use the SAP Cloud SDK in the Browser",sidebar_label:"Use the SAP Cloud SDK in the Browser",description:"You'll learn how to package SDK for a browser, what are the limitations, and how to use it with popular frontend frameworks.",keywords:["sap","cloud","sdk","cloud native","cloud sdk","sap cloud sdk"]},l=void 0,a={},d=[{value:"Prerequisite",id:"prerequisite",level:2},{value:"Include the SAP Cloud SDK",id:"include-the-sap-cloud-sdk",level:2},{value:"Run Locally",id:"run-locally",level:2},{value:"Run on SAP BTP, Cloud Foundry Environment",id:"run-on-sap-btp-cloud-foundry-environment",level:2},{value:"Workaround",id:"workaround",level:2},{value:"Angular",id:"angular",level:3},{value:"React",id:"react",level:3}];function c(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.admonition,{title:"Warning",type:"danger",children:(0,o.jsx)(n.p,{children:"Using SAP Cloud SDK for frontend use cases (in the browser) is not recommended in general, the tips shown in this document are just workaround and therefore might not work."})}),"\n",(0,o.jsx)(n.p,{children:"Because of the specifics of a browser environment, some SAP Cloud SDK features might be unavailable.\nTo help you get up and running faster in a browser, this document outlines the main steps and caveats of using SAP Cloud SDK on the frontend.\nBoth Angular and React applications are used to illustrate the usage."}),"\n",(0,o.jsx)(n.h2,{id:"prerequisite",children:"Prerequisite"}),"\n",(0,o.jsx)(n.p,{children:"A frontend application set up using either of the following:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://angular.io/cli/new",children:"Angular application"})," via ",(0,o.jsx)(n.code,{children:"ng new my-app"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://reactjs.org/docs/create-a-new-react-app.html#create-react-app",children:"React application"})," via ",(0,o.jsx)(n.code,{children:"npx create-react-app my-app"}),".\nRewire the create-react-app project using ",(0,o.jsx)(n.a,{href:"https://github.com/timarney/react-app-rewired#how-to-rewire-your-create-react-app-project",children:"react-app-rewired"})," or other alternatives.\nThis creates a ",(0,o.jsx)(n.code,{children:"config-overrides.js"})," file in the root directory which can be used to override the settings for various webpack modules."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"include-the-sap-cloud-sdk",children:"Include the SAP Cloud SDK"}),"\n",(0,o.jsxs)(n.p,{children:["The example below uses the business partner API.\nTo learn how to generate an API client from a service definition, refer to ",(0,o.jsx)(n.a,{href:"/cloud-sdk/docs/js/v3/features/odata/generate-client",children:"this article"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"//In the .html part of the component\n<button (click)=\"callApi()\">Click me!</button>\n\n//In the .ts part of the component\nimport { businessPartnerService } from './generated/business-partner-service';\n\nconst { businessPartnerApi } = businessPartnerService();\n\nasync function callApi(){\n  const result = await businessPartnerApi.requestBuilder().getAll().execute(myDest)\n  console.log(result)\n}\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsxs)(n.p,{children:["For the destination lookup, the SAP Cloud SDK relies on Node.js functionality, e.g., ",(0,o.jsx)(n.code,{children:"process.env"}),".\nHowever, the request building, execution, and result parsing do not require any Node.js modules and can be used on the frontend.\nHence, create the destination variable ",(0,o.jsx)(n.code,{children:"myDest"})," manually."]})}),"\n",(0,o.jsxs)(n.p,{children:["Executing ",(0,o.jsx)(n.code,{children:"npm run build"})," will result in compilation errors of the kind shown below:"]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:"Module not found: Error: Can't resolve 'https' in"}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Check out the ",(0,o.jsx)(n.a,{href:"#workaround",children:"workaround"})," for resolving such errors."]}),"\n",(0,o.jsx)(n.h2,{id:"run-locally",children:"Run Locally"}),"\n",(0,o.jsxs)(n.p,{children:["As discussed above, the ",(0,o.jsx)(n.code,{children:"myDest"})," can not be fetched via the destination service.\nCreate and pass the variable when running locally."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import { Destination } from '@sap-cloud-sdk/connectivity';\n\nconst myDest: Destination = {\n  url: 'https://my123456.s4hana.ondemand.com',\n  username: 'myUser',\n  password: 'myPassowrd'\n};\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Executing ",(0,o.jsx)(n.code,{children:"npm run serve"})," compiles the project and hosts the application on a local server."]}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["All modern browsers block requests triggered from a browser to a remote system to ensure ",(0,o.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Same-origin_policy",children:"same origin policy"}),".\nOne simple way to overcome this issue locally is to disable the web security of the browser temporarily (e.g. ",(0,o.jsx)(n.code,{children:"--disable-web-security"})," for Chrome).\nAlternatively, create a second localhost proxy server that adds the ",(0,o.jsx)(n.code,{children:"access-allow-origin-header"})," to the request."]})}),"\n",(0,o.jsx)(n.h2,{id:"run-on-sap-btp-cloud-foundry-environment",children:"Run on SAP BTP, Cloud Foundry Environment"}),"\n",(0,o.jsxs)(n.p,{children:["For productive usage, the methods mentioned above for running locally are not needed.\nConfigure the ",(0,o.jsx)(n.code,{children:"xs-app.json"})," file of the approuter with an entry as shown below:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "source": "/REMOTE_SYSTEM_IDENTIFIER/(.*)",\n  "target": "/$1",\n  "destination": "DESTINATION_NAME_ON_CF"\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"and then, in the application, define the destination as follows:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import { Destination } from '@sap-cloud-sdk/connectivity';\n\nconst myDest: Destination = {\n  url: '/REMOTE_SYSTEM_IDENTIFIER'\n};\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The created request to ",(0,o.jsx)(n.code,{children:"/REMOTE_SYSTEM_IDENTIFIER/sap/opu/odata/sap/API_BUSINESS_PARTNER/A_BusinessPartner"})," will be matched by the approuter and the destination with the given URL and credentials is used."]}),"\n",(0,o.jsxs)(n.p,{children:["The approuter establishes a session with the client (browser) using a session cookie.\nThis session contains elements like the redirect URL, OAuth token, OAuth scopes, etc.\nOAuth token is a JSON Web Token (JWT) that is fetched from the UAA and forwarded to backend services in the Authorization header.\n",(0,o.jsx)(n.strong,{children:"The client never gets this token."})]}),"\n",(0,o.jsxs)(n.p,{children:["For a detailed understanding of session handling in the application router, refer to the documentation ",(0,o.jsx)(n.a,{href:"https://help.sap.com/docs/SAP_HANA_PLATFORM/4505d0bdaf4948449b7f7379d24d0f0d/96c7545f62504d55b669010d8fb9c41e.html?version=2.0.00",children:"here"}),"."]}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsxs)(n.p,{children:["This approach does not support principal propagation to on-premise systems.\nFor this, you need a JWT and need to include the proper header fields defining the user.\nSee the documentation on ",(0,o.jsx)(n.a,{href:"../features/connectivity/on-premise",children:"on-premise systems"})," for details."]})}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["With webpack, it is possible to ",(0,o.jsx)(n.a,{href:"https://webpack.js.org/plugins/normal-module-replacement-plugin/",children:"load resources"})," for local or productive usage.\nUsing such a switch, you can adjust the value of the destination for the two cases."]})}),"\n",(0,o.jsx)(n.h2,{id:"workaround",children:"Workaround"}),"\n",(0,o.jsx)(n.p,{children:"Webpack version 5 removed the automatic node.js polyfills and they need to be added manually.\nAn error message during the compilation from TS to JS provides a hint on how to achieve that."}),"\n",(0,o.jsx)(n.h3,{id:"angular",children:"Angular"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Add the corresponding library of the node.js core modules or the browserified version in ",(0,o.jsx)(n.code,{children:"devDependencies"})," in your ",(0,o.jsx)(n.code,{children:"package.json"})," file"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Include ",(0,o.jsx)(n.code,{children:"@angular-builders/custom-webpack"})," in ",(0,o.jsx)(n.code,{children:"devDependencies"})]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Create a custom webpack configuration named ",(0,o.jsx)(n.code,{children:"node-webpack.config.js"})," and list the node modules"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"module.exports = {\n  resolve: {\n    alias: {\n      process: 'process/browser',\n      https: 'agent-base',\n      http: 'agent-base'\n    },\n    fallback: {\n      url: false,\n      os: false,\n      assert: false,\n      constants: false,\n      zlib: false,\n      path: false,\n      http: false,\n      util: require.resolve('util/'),\n      process: require.resolve('process/browser'),\n      stream: require.resolve('stream-browserify'),\n      buffer: require.resolve('buffer'),\n      crypto: require.resolve('crypto-browserify'),\n      https: require.resolve('https-browserify')\n    }\n  },\n  plugins: [new ProvidePlugin({ process: 'process/browser' })]\n};\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["In the ",(0,o.jsx)(n.code,{children:"angular.json"})," file, adjust the ",(0,o.jsx)(n.code,{children:"build"})," target to use the custom builder and set ",(0,o.jsx)(n.code,{children:"path"})," to the custom config ",(0,o.jsx)(n.code,{children:"node-webpack.config.js"})," defined above"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'"build": {\n  "builder": "@angular-builders/custom-webpack:browser",\n  "options": {\n    "customWebpackConfig": {\n      "path": "./node-webpack.config.js"\n    }\n  }\n'})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["In the ",(0,o.jsx)(n.code,{children:"angular.json"})," file, adjust the ",(0,o.jsx)(n.code,{children:"serve"})," target to use the custom builder as well"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'"serve": {\n  "builder": "@angular-builders/custom-webpack:dev-server",\n'})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["In the ",(0,o.jsx)(n.code,{children:"package.json"})," file, exclude the node modules that do not exist in the browser"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'"browser": {\n  "fs": false,\n  "net": false,\n  "tls": false\n}\n'})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Proxy any requests to your API server in development by adding a ",(0,o.jsx)(n.code,{children:"proxy.config.json"})," file in ",(0,o.jsx)(n.code,{children:"/src"})," folder\nThis avoids the CORS issues."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "/api/*": {\n    "target": "REMOTE_SYSTEM_IDENTIFIER",\n    "secure": true,\n    "logLevel": "debug",\n    "changeOrigin": true\n  }\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Since the base path has been set in the proxy config, change the value of the ",(0,o.jsx)(n.code,{children:"url"})," property in ",(0,o.jsx)(n.code,{children:"myDest"})," to ",(0,o.jsx)(n.code,{children:"/"}),".\nIn the ",(0,o.jsx)(n.code,{children:"angular.json"})," file, adjust the ",(0,o.jsx)(n.code,{children:"serve"})," options to include ",(0,o.jsx)(n.code,{children:"proxyConfig"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'"proxyConfig": "src/proxy.conf.json"\n'})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"react",children:"React"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Add the corresponding library of the core node.js modules in ",(0,o.jsx)(n.code,{children:"devDependencies"})," in your ",(0,o.jsx)(n.code,{children:"package.json"})," file.\nAdd the ",(0,o.jsx)(n.code,{children:"react-app-rewired"})," dependency and adjust the existing calls to ",(0,o.jsx)(n.code,{children:"react-scripts"})," in npm scripts for ",(0,o.jsx)(n.code,{children:"start"}),", ",(0,o.jsx)(n.code,{children:"build"})," and ",(0,o.jsx)(n.code,{children:"test"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'"start": "react-app-rewired start"\n'})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["In the ",(0,o.jsx)(n.code,{children:"config-overrides.js"})," file, list the core node modules"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"module.exports = function override(config, env) {\n  config.ignoreWarnings = [/Failed to parse source map/];\n  config.resolve.alias = {\n    https: 'agent-base',\n    http: 'agent-base'\n  };\n  config.resolve.fallback = {\n    os: false,\n    url: false,\n    https: false,\n    http: false,\n    fs: false,\n    path: false,\n    assert: false,\n    zlib: false,\n    tls: false,\n    net: false,\n    constants: false,\n    util: require.resolve('util'),\n    process: require.resolve('process/browser'),\n    stream: require.resolve('stream-browserify'),\n    buffer: require.resolve('buffer'),\n    console: require.resolve('console-browserify'),\n    crypto: require.resolve('crypto-browserify'),\n    https: require.resolve('https-browserify')\n  };\n  config.plugins = [\n    ...config.plugins,\n    new ProvidePlugin({\n      Buffer: ['buffer', 'Buffer']\n    }),\n    new ProvidePlugin({\n      process: 'process/browser'\n    }),\n    new NormalModuleReplacementPlugin(/^node:/, resource => {\n      resource.request = resource.request.replace(/^node:/, '');\n    })\n  ];\n\n  return config;\n};\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Proxy any requests to your API server in development by adding a proxy field to the ",(0,o.jsx)(n.code,{children:"package.json"})," file.\nThis avoids the CORS issues."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'"proxy": "REMOTE_SYSTEM_IDENTIFIER",\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Since the base path has been set in the proxy, change the value of the ",(0,o.jsx)(n.code,{children:"url"})," property in ",(0,o.jsx)(n.code,{children:"myDest"})," to ",(0,o.jsx)(n.code,{children:"/"})]}),"\n",(0,o.jsx)(n.admonition,{type:"caution",children:(0,o.jsx)(n.p,{children:"This proxy is only for development.\nYou need to ensure that API URLs point to the right target in production."})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Now, the project should build and run locally."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>l});var r=s(96540);const o={},t=r.createContext(o);function i(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);